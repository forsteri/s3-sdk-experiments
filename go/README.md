# S3 Uploader - Goç‰ˆ

Pythonç‰ˆã®S3 Uploaderã‚’Goã§å†å®Ÿè£…ã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚**ã‚·ãƒ³ã‚°ãƒ«ãƒã‚¤ãƒŠãƒªã§å‹•ä½œ**ã—ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ã§è¤‡æ•°ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•å®Ÿè¡Œã§ãã¾ã™ã€‚

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
# ãƒ“ãƒ«ãƒ‰
make build

# å®Ÿè¡Œï¼ˆconfig.jsonã®å…¨ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œï¼‰
./bin/s3-uploader

# ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
./bin/s3-uploader --version

# ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ãƒ¢ãƒ¼ãƒ‰
./bin/s3-uploader --dry-run

# ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼ˆå˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰
./bin/s3-uploader --test
```

## ä¸»ãªæ©Ÿèƒ½

- ğŸ“ å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã® S3 ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- ğŸš€ ä¸¦åˆ—ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ï¼ˆãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ—ãƒ¼ãƒ«æ–¹å¼ï¼‰
- ğŸ“¦ ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆå¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œï¼‰
- âš¡ ä¸¦åˆ—ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆé«˜é€Ÿè»¢é€ï¼‰
- ğŸ”„ è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ï¼ˆæŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ï¼‰
- ğŸ“Š é€²æ—è¡¨ç¤ºæ©Ÿèƒ½ï¼ˆãƒ­ã‚°å‡ºåŠ›å¯¾å¿œï¼‰
- ğŸƒ ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ãƒ¢ãƒ¼ãƒ‰
- ğŸ¯ é™¤å¤–ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚µãƒãƒ¼ãƒˆ
- ğŸ“‹ ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼ï¼ˆè¨­å®šãƒ™ãƒ¼ã‚¹ã®è‡ªå‹•å®Ÿè¡Œï¼‰
- ğŸ” AssumeRoleå¯¾å¿œ

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
go/
â”œâ”€â”€ Makefile            # ãƒ“ãƒ«ãƒ‰ãƒ»é–‹ç™ºã‚¿ã‚¹ã‚¯ç®¡ç†
â”œâ”€â”€ go.mod              # Goãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å®šç¾©
â”œâ”€â”€ go.sum              # ä¾å­˜é–¢ä¿‚ã®ãƒã‚§ãƒƒã‚¯ã‚µãƒ 
â”œâ”€â”€ main.go             # ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆï¼ˆs3-uploaderï¼‰
â”œâ”€â”€ config.json         # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ cmd/                # å€‹åˆ¥ãƒ„ãƒ¼ãƒ«ï¼ˆé–‹ç™ºãƒ»ãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
â”‚   â”œâ”€â”€ task-runner/    # ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼å˜ä½“ï¼ˆmain.goã¨åŒç­‰æ©Ÿèƒ½ï¼‰
â”‚   â”œâ”€â”€ scan-test/      # ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ client-test/    # S3ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ upload-test/    # ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ parallel-test/  # ä¸¦åˆ—ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ multipart-test/ # ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ internal/           # å†…éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
â”‚   â”œâ”€â”€ models/         # è¨­å®šç®¡ç†
â”‚   â”œâ”€â”€ logger/         # ãƒ­ã‚°ç®¡ç†
â”‚   â”œâ”€â”€ version/        # ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±
â”‚   â”œâ”€â”€ fileutils/      # ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ã‚­ãƒ£ãƒ³
â”‚   â”œâ”€â”€ aws/            # AWS/S3é–¢é€£
â”‚   â”œâ”€â”€ uploader/       # ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†
â”‚   â””â”€â”€ progress/       # é€²æ—ç®¡ç†
â”œâ”€â”€ scripts/            # ãƒ†ã‚¹ãƒˆãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â””â”€â”€ bin/                # ãƒ“ãƒ«ãƒ‰æˆæœç‰©ï¼ˆ.gitignoreï¼‰
    â””â”€â”€ s3-uploader     # ãƒ¡ã‚¤ãƒ³ãƒã‚¤ãƒŠãƒªï¼ˆã‚·ãƒ³ã‚°ãƒ«ãƒã‚¤ãƒŠãƒªï¼‰
```

**æ³¨**: `s3-uploader`ãƒã‚¤ãƒŠãƒª1ã¤ã§å…¨æ©Ÿèƒ½ãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€‚`cmd/`é…ä¸‹ã®ãƒ„ãƒ¼ãƒ«ã¯é–‹ç™ºãƒ»ãƒ‡ãƒãƒƒã‚°ç”¨ã®å€‹åˆ¥æ©Ÿèƒ½ã§ã™ã€‚

## é–‹ç™ºã®é€²ã‚æ–¹

1. **è¨­å®šç®¡ç†**: JSONãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã¨æ§‹é€ ä½“ã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚° âœ…
2. **AWSæ¥ç¶š**: SDK v2ã‚’ä½¿ã£ãŸS3ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ä½œæˆ âœ…
3. **ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã¨ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æº–å‚™ âœ…
4. **ä¸¦åˆ—å‡¦ç†**: goroutinesã‚’ä½¿ã£ãŸä¸¦åˆ—ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ âœ…
5. **é€²æ—è¡¨ç¤º**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€²æ—ç®¡ç† âœ…
6. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: ãƒªãƒˆãƒ©ã‚¤ã¨ãƒ­ã‚°å‡ºåŠ› âœ…

## å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½

### ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ã‚­ãƒ£ãƒ³æ©Ÿèƒ½ (internal/fileutils)
- Pythonç‰ˆã¨åŒç­‰ã®æ©Ÿèƒ½ã‚’å®Ÿè£…
- é™¤å¤–ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚µãƒãƒ¼ãƒˆï¼ˆ*.tmp, .DS_Store ãªã©ï¼‰
- å†å¸°çš„/éå†å¸°çš„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚¹ã‚­ãƒ£ãƒ³
- å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±ã®å–å¾—
- åŒ…æ‹¬çš„ãªãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã¨ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆ

### AWS S3ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç®¡ç† (internal/aws)
- è¨­å®šãƒ™ãƒ¼ã‚¹ã®S3ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä½œæˆ
- ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«èªè¨¼ã¨AssumeRoleå¯¾å¿œ
- ãƒªãƒˆãƒ©ã‚¤è¨­å®šã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
- S3æ“ä½œãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ï¼ˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€ä¸€è¦§å–å¾—ã€å­˜åœ¨ç¢ºèªï¼‰
- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä»˜ãã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- Content-Typeã®è‡ªå‹•æ¨æ¸¬

### ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ (internal/uploader)
- å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆå†å¸°çš„/éå†å¸°çš„ï¼‰
- ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ
- ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ï¼ˆæŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ï¼‰
- é™¤å¤–ãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©ç”¨
- è©³ç´°ãªã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çµæœãƒ¬ãƒãƒ¼ãƒˆ

### ä¸¦åˆ—ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ (internal/uploader/parallel.go)
- ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ—ãƒ¼ãƒ«æ–¹å¼ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªä¸¦åˆ—å‡¦ç†
- è¨­å®šå¯èƒ½ãªãƒ¯ãƒ¼ã‚«ãƒ¼æ•°ï¼ˆconfig.jsonã®parallel_uploadsï¼‰
- ãƒ•ã‚¡ã‚¤ãƒ«æ•°ã«å¿œã˜ãŸè‡ªå‹•çš„ãªä¸¦åˆ—/é †æ¬¡å‡¦ç†ã®åˆ‡ã‚Šæ›¿ãˆ
- å„ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒç‹¬ç«‹ã—ã¦ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ã‚’å®Ÿè¡Œ
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®çµ±è¨ˆæƒ…å ±è¿½è·¡ï¼ˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ•°ã€å¤±æ•—æ•°ã€ç·ãƒã‚¤ãƒˆæ•°ï¼‰
- ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ã‚ˆã‚‹é©åˆ‡ãªã‚­ãƒ£ãƒ³ã‚»ãƒ«å‡¦ç†
- é€²æ—è¿½è·¡æ©Ÿèƒ½ã¨ã®çµ±åˆ

### é€²æ—è¡¨ç¤ºæ©Ÿèƒ½ (internal/progress)
- ã‚µãƒ¼ãƒãƒ¼ç’°å¢ƒå‘ã‘ã®ãƒ­ã‚°ãƒ™ãƒ¼ã‚¹é€²æ—è¡¨ç¤ºï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
- å®šæœŸçš„ãªé€²æ—ãƒ¬ãƒãƒ¼ãƒˆï¼ˆ30ç§’é–“éš”ã€è¨­å®šå¤‰æ›´å¯èƒ½ï¼‰
- ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼è¡¨ç¤ºï¼‰ã‚‚ã‚µãƒãƒ¼ãƒˆ
- ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¯ãƒ¼ã‚«ãƒ¼ã®çŠ¶æ…‹è¿½è·¡
- è»¢é€é€Ÿåº¦ã¨ETAï¼ˆæ¨å®šæ®‹ã‚Šæ™‚é–“ï¼‰ã®è¨ˆç®—
- atomicæ“ä½œã«ã‚ˆã‚‹å®‰å…¨ãªä¸¦åˆ—æ›´æ–°

### ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼æ©Ÿèƒ½ (internal/uploader/task_runner.go)
- config.jsonã®upload_tasksã‚’è‡ªå‹•å®Ÿè¡Œ
- å€‹åˆ¥ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡Œã‚‚ã‚µãƒãƒ¼ãƒˆ
- å®Ÿè¡Œçµæœã®è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ
- ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ
- å¤±æ•—æ™‚ã®é©åˆ‡ãªçµ‚äº†ã‚³ãƒ¼ãƒ‰
- ä¸¦åˆ—ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¯¾å¿œ

### ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ (internal/aws/multipart.go, multipart_parallel.go)
- å¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«ã®åŠ¹ç‡çš„ãªã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 100MBä»¥ä¸Šï¼‰
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¤‡æ•°ã®ãƒ‘ãƒ¼ãƒˆã«åˆ†å‰²ã—ã¦ä¸¦åˆ—è»¢é€
- è¨­å®šå¯èƒ½ãªãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚ºï¼ˆconfig.jsonã®multipart_chunksizeï¼‰
- é †æ¬¡ãƒ»ä¸¦åˆ—ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®ä¸¡æ–¹ã‚’ã‚µãƒãƒ¼ãƒˆ
- ã‚¨ãƒ©ãƒ¼æ™‚ã®è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆAbortMultipartUploadï¼‰
- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­ã®é€²æ—è¿½è·¡
- ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ—ãƒ¼ãƒ«æ–¹å¼ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªä¸¦åˆ—å‡¦ç†
- ReadAt ã‚’ä½¿ç”¨ã—ãŸã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•ãªãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿

### ä½¿ç”¨æ–¹æ³•

1. **ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ**:
   ```bash
   chmod +x test_fileutils.sh
   ./test_fileutils.sh
   ```

2. **ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**:
   ```bash
   go run cmd/scan-test/main.go
   ```

3. **S3ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**:
   ```bash
   go run cmd/client-test/main.go
   # ã¾ãŸã¯ç‰¹å®šã®ãƒã‚±ãƒƒãƒˆã‚’æŒ‡å®š
   go run cmd/client-test/main.go -bucket your-bucket-name
   ```

4. **ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œ**:
   ```bash
   # é€šå¸¸ãƒ¢ãƒ¼ãƒ‰ï¼ˆã™ã¹ã¦ã®ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œï¼‰
   go run main.go
   
   # ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼ˆå˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®ãƒ†ã‚¹ãƒˆï¼‰
   go run main.go -test
   
   # ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ãƒ¢ãƒ¼ãƒ‰
   go run main.go -dry-run
   ```

5. **ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼ã®å®Ÿè¡Œ**:
   ```bash
   # ã™ã¹ã¦ã®ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ
   go run cmd/task-runner/main.go
   
   # ç‰¹å®šã®ã‚¿ã‚¹ã‚¯ã®ã¿ã‚’å®Ÿè¡Œ
   go run cmd/task-runner/main.go -task sample_data
   
   # ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ãƒ¢ãƒ¼ãƒ‰
   go run cmd/task-runner/main.go -dry-run
   ```

6. **ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ**:
   ```bash
   # å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
   go run cmd/upload-test/main.go -source ../test-data/sample_data.csv -key test/sample.csv
   
   # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
   go run cmd/upload-test/main.go -source ../test-data/exports -key exports/ -recursive
   
   # ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ãƒ¢ãƒ¼ãƒ‰
   go run cmd/upload-test/main.go -source ../test-data -dry-run -recursive
   ```

7. **ä¸¦åˆ—ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**:
   ```bash
   # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä¸¦åˆ—ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 3ãƒ¯ãƒ¼ã‚«ãƒ¼ï¼‰
   go run cmd/parallel-test/main.go -source ../test-data -recursive
   
   # ãƒ¯ãƒ¼ã‚«ãƒ¼æ•°ã‚’æŒ‡å®š
   go run cmd/parallel-test/main.go -source ../test-data -recursive -workers 8
   
   # é †æ¬¡å‡¦ç†ã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆæ¯”è¼ƒç”¨ï¼‰
   go run cmd/parallel-test/main.go -source ../test-data -recursive -parallel=false
   
   # ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ï¼ˆä¸¦åˆ— vs é †æ¬¡ã®æ€§èƒ½æ¯”è¼ƒï¼‰
   go run cmd/parallel-test/main.go -benchmark ../test-data
   ```

8. **é€²æ—è¡¨ç¤ºæ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ**:
   ```bash
   # ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ
   chmod +x test_progress.sh
   ./test_progress.sh
   ```

9. **ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**:
   ```bash
   # å¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
   go run cmd/multipart-test/main.go -source bigfile.zip -bucket your-bucket -key test/bigfile.zip
   
   # å¼·åˆ¶çš„ã«ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ï¼ˆå°ã•ã„ãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚‚ï¼‰
   go run cmd/multipart-test/main.go -source file.txt -bucket your-bucket -key test/file.txt -multipart
   
   # ä¸¦åˆ—ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆãƒ¯ãƒ¼ã‚«ãƒ¼æ•°æŒ‡å®šï¼‰
   go run cmd/multipart-test/main.go -source bigfile.zip -bucket your-bucket -key test/bigfile.zip -workers 8
   
   # ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚ºã‚’æŒ‡å®šï¼ˆMBå˜ä½ï¼‰
   go run cmd/multipart-test/main.go -source bigfile.zip -bucket your-bucket -key test/bigfile.zip -chunk-size 10
   
   # ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ï¼ˆé€šå¸¸ vs é †æ¬¡ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆ vs ä¸¦åˆ—ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆã®æ¯”è¼ƒï¼‰
   go run cmd/multipart-test/main.go -source bigfile.zip -bucket your-bucket -key test/bigfile -benchmark
   
   # ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ãƒ¢ãƒ¼ãƒ‰
   go run cmd/multipart-test/main.go -source bigfile.zip -bucket your-bucket -key test/bigfile.zip -dry-run
   ```

## ä¸¦åˆ—ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®ç‰¹å¾´

- **è‡ªå‹•æœ€é©åŒ–**: ãƒ•ã‚¡ã‚¤ãƒ«æ•°ãŒå°‘ãªã„å ´åˆã¯é †æ¬¡å‡¦ç†ã€å¤šã„å ´åˆã¯ä¸¦åˆ—å‡¦ç†ã‚’è‡ªå‹•é¸æŠ
- **åŠ¹ç‡çš„ãªãƒªã‚½ãƒ¼ã‚¹ç®¡ç†**: ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ—ãƒ¼ãƒ«æ–¹å¼ã§goroutineã‚’åŠ¹ç‡çš„ã«ç®¡ç†
- **ãƒªãƒˆãƒ©ã‚¤å¯¾å¿œ**: å„ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒç‹¬ç«‹ã—ã¦ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ã‚’å®Ÿè¡Œ
- **é€²æ—è¿½è·¡**: atomicæ“ä½œã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«é€²æ—ã‚’è¿½è·¡
- **ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯æ©Ÿèƒ½**: ç•°ãªã‚‹ãƒ¯ãƒ¼ã‚«ãƒ¼æ•°ã§ã®æ€§èƒ½æ¯”è¼ƒãŒå¯èƒ½

## è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (config.json)

### é€²æ—è¡¨ç¤ºã®è¨­å®š
```json
{
  "options": {
    "enable_progress": true,      // é€²æ—è¡¨ç¤ºã®æœ‰åŠ¹/ç„¡åŠ¹
    "parallel_uploads": 3,        // ä¸¦åˆ—ãƒ¯ãƒ¼ã‚«ãƒ¼æ•°ï¼ˆ1ã§é †æ¬¡å‡¦ç†ï¼‰
    // ãã®ä»–ã®è¨­å®š...
  }
}
```

### é€²æ—ãƒ­ã‚°ã®å‡ºåŠ›ä¾‹
``` text
2024-03-15 10:30:00 - INFO - Upload progress - completed=150 total=500 processed=140 failed=5 skipped=5 bytes_processed=1073741824 speed_mbps=10.24 elapsed=1m40s eta=4m10s percentage=30.0%
```

## ã‚µãƒ¼ãƒãƒ¼ç’°å¢ƒã§ã®åˆ©ç”¨

ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã‚µãƒ¼ãƒãƒ¼ç’°å¢ƒã§ã®å®šæœŸå®Ÿè¡Œã‚’æƒ³å®šã—ã¦è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ï¼š

- **Cronè¨­å®šä¾‹**:
  ```bash
  # æ¯æ—¥åˆå‰2æ™‚ã«å®Ÿè¡Œ
  0 2 * * * /path/to/go run /path/to/main.go >> /var/log/s3-uploader.log 2>&1
  ```

- **systemdã‚µãƒ¼ãƒ“ã‚¹ä¾‹**:
  ```ini
  [Unit]
  Description=S3 Uploader Service
  After=network.target

  [Service]
  Type=oneshot
  ExecStart=/usr/local/bin/go run /path/to/main.go
  StandardOutput=journal
  StandardError=journal

  [Timer]
  OnCalendar=daily
  Persistent=true

  [Install]
  WantedBy=timers.target
  ```

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ã™ã¹ã¦ã®ä¸»è¦æ©Ÿèƒ½ãŒå®Ÿè£…ã•ã‚Œã¾ã—ãŸï¼âœ¨
ä»Šå¾Œã®æ‹¡å¼µæ¡ˆï¼š
- âœ… ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯¾å¿œï¼ˆå¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«å‘ã‘ï¼‰â†’ å®Ÿè£…æ¸ˆã¿ï¼
- ãƒ¡ãƒˆãƒªã‚¯ã‚¹å‡ºåŠ›ï¼ˆPrometheuså½¢å¼ï¼‰
- Slack/Emailé€šçŸ¥æ©Ÿèƒ½
- å·®åˆ†ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
- ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ¡ãƒ¢ãƒªã«èª­ã¿è¾¼ã¾ãšã«è»¢é€ï¼‰
